/* (c) 2013 Karthikeyan VJ */
var com;(function(com){(function(goldenratio){var SoundType=(function(){function SoundType(){}
SoundType.LASER="com.goldenratio.SoundType.LASER";SoundType.ENEMY_HIT="com.goldenratio.SoundType.ENEMY_HIT";SoundType.ENEMY_SINGLE_HIT="com.goldenratio.SoundType.ENEMY_SINGLE_HIT";SoundType.PLAYER_HIT="com.goldenratio.SoundType.PLAYER_HIT";SoundType.PLAYER_DIE="com.goldenratio.SoundType.PLAYER_DIE";SoundType.CLICK="com.goldenratio.SoundType.CLICK";return SoundType;})();goldenratio.SoundType=SoundType;var GraphicsType=(function(){function GraphicsType(){}
GraphicsType.MUTE="com.goldenratio.GraphicsType.MUTE";return GraphicsType;})();goldenratio.GraphicsType=GraphicsType;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d;}
__.prototype=b.prototype;d.prototype=new __();};var com;(function(com){(function(goldenratio){(function(utils){var KeyboardEnum=(function(){function KeyboardEnum(){}
KeyboardEnum.UP=38;KeyboardEnum.DOWN=40;KeyboardEnum.LEFT=37;KeyboardEnum.RIGHT=39;KeyboardEnum.Z=90;KeyboardEnum.P=80;KeyboardEnum.M=77;KeyboardEnum.W=87;KeyboardEnum.A=65;KeyboardEnum.S=83;KeyboardEnum.D=68;KeyboardEnum.L=76;return KeyboardEnum;})();utils.KeyboardEnum=KeyboardEnum;var KeyEvent=(function(){function KeyEvent(){}
KeyEvent.PAUSE_TOGGLED="com.goldenratio.utils.KeyEvent.PAUSE_TOGGLED";KeyEvent.MUTE_TOGGLED="com.goldenratio.utils.KeyEvent.MUTE_TOGGLED";return KeyEvent;})();utils.KeyEvent=KeyEvent;var Keyboard=(function(_super){__extends(Keyboard,_super);function Keyboard(){_super.call(this);this.isUp=false;this.isDown=false;this.isRight=false;this.isLeft=false;this.isFire=false;this.isPause=false;this.isMute=false;}
Keyboard.prototype.init=function(){this.onWindowBlurHL=this.onWindowBlur.bind(this);this.onKeyDownHL=this.onKeyDown.bind(this);this.onKeyUpHL=this.onKeyUp.bind(this);document.addEventListener("keydown",this.onKeyDownHL,false);document.addEventListener("keyup",this.onKeyUpHL,false);window.addEventListener("blur",this.onWindowBlurHL,false);};Keyboard.prototype.setMute=function(value){this.isMute=value;};Keyboard.prototype.onWindowBlur=function(){console.log("blur");if(this.isPause==true){return;}
this.isPause=true;var e=new KeyEvent();e.pauseState=this.isPause;e.type=KeyEvent.PAUSE_TOGGLED;this.dispatchEvent(e,null);};Keyboard.prototype.isKeyPress=function(keyCode){if(keyCode==KeyboardEnum.UP){return this.isUp;}else if(keyCode==KeyboardEnum.DOWN){return this.isDown;}else if(keyCode==KeyboardEnum.LEFT){return this.isLeft;}else if(keyCode==KeyboardEnum.RIGHT){return this.isRight;}else if(keyCode==KeyboardEnum.Z){return this.isFire;}else if(keyCode==KeyboardEnum.P){return this.isPause;}
return false;};Keyboard.prototype.onKeyDown=function(event){var validKey=false;if(event.keyCode==KeyboardEnum.UP||event.keyCode==KeyboardEnum.W){this.isUp=true;this.isDown=false;validKey=true;}else if(event.keyCode==KeyboardEnum.DOWN||event.keyCode==KeyboardEnum.S){this.isUp=false;this.isDown=true;validKey=true;}
if(event.keyCode==KeyboardEnum.LEFT||event.keyCode==KeyboardEnum.A){this.isLeft=true;this.isRight=false;validKey=true;}else if(event.keyCode==KeyboardEnum.RIGHT||event.keyCode==KeyboardEnum.D){this.isLeft=false;this.isRight=true;validKey=true;}
if(event.keyCode==KeyboardEnum.Z||event.keyCode==KeyboardEnum.L){this.isFire=true;validKey=true;}
if(validKey==true){event.preventDefault();}};Keyboard.prototype.onKeyUp=function(event){var validKey=false;if(event.keyCode==KeyboardEnum.UP||event.keyCode==KeyboardEnum.W){this.isUp=false;validKey=true;}
if(event.keyCode==KeyboardEnum.DOWN||event.keyCode==KeyboardEnum.S){this.isDown=false;validKey=true;}
if(event.keyCode==KeyboardEnum.LEFT||event.keyCode==KeyboardEnum.A){this.isLeft=false;validKey=true;}
if(event.keyCode==KeyboardEnum.RIGHT||event.keyCode==KeyboardEnum.D){this.isRight=false;validKey=true;}
if(event.keyCode==KeyboardEnum.Z||event.keyCode==KeyboardEnum.L){this.isFire=false;validKey=true;}
if(event.keyCode==KeyboardEnum.P){this.isPause=!this.isPause;validKey=true;var e=new KeyEvent();e.pauseState=this.isPause;e.type=KeyEvent.PAUSE_TOGGLED;this.dispatchEvent(e,null);}
if(event.keyCode==KeyboardEnum.M){this.isMute=!this.isMute;validKey=true;var e=new KeyEvent();e.muteState=this.isMute;e.type=KeyEvent.MUTE_TOGGLED;this.dispatchEvent(e,null);}
if(validKey==true){event.preventDefault();}};Keyboard.prototype.dispose=function(){document.removeEventListener("keydown",this.onKeyDownHL,false);document.removeEventListener("keyup",this.onKeyUpHL,false);window.removeEventListener("blur",this.onWindowBlurHL,false);this.onWindowBlurHL=null;this.onKeyDownHL=null;this.onKeyUpHL=null;};return Keyboard;})(createjs.EventDispatcher);utils.Keyboard=Keyboard;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(hero){var HeroEvent=(function(){function HeroEvent(){}
HeroEvent.FIRE_BULLET="com.goldenratio.HeroEvent.FIRE_BULLET";HeroEvent.PLAYER_HIT="com.goldenratio.HeroEvent.PLAYER_HIT";HeroEvent.DIE="com.goldenratio.HeroEvent.DIE";HeroEvent.MISSION_COMPLETE="com.goldenratio.HeroEvent.MISSION_COMPLETE";return HeroEvent;})();hero.HeroEvent=HeroEvent;})(goldenratio.hero||(goldenratio.hero={}));var hero=goldenratio.hero;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var BasicDisplayObject=(function(_super){__extends(BasicDisplayObject,_super);function BasicDisplayObject(){_super.call(this);}
BasicDisplayObject.prototype.getBounds=function(){return null;};BasicDisplayObject.prototype.dispose=function(){this.uncache();this.removeAllChildren();};return BasicDisplayObject;})(createjs.Container);goldenratio.BasicDisplayObject=BasicDisplayObject;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(hero){var Hero=(function(_super){__extends(Hero,_super);function Hero(keyboardRef){_super.call(this);this.size=10;this.shootAnimatePending=false;this.speed=0.8;this.velocity=new createjs.Point();this.friction=0.93;this.maxSpeed=8;this.reloadSpeed=150;this.isAlive=true;this.canRemove=false;this.healthValue=100;this.keyboard=keyboardRef;this.isAlive=true;this.healthValue=100;this.canRemove=false;this.colorValue=createjs.Graphics.getRGB(255,255,255,0.6);var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(this.colorValue);gfx.drawCircle(0,0,this.size);gfx.endStroke();this.shape=new createjs.Shape(gfx);this.shape.shadow=new createjs.Shadow(createjs.Graphics.getRGB(255,255,255,0.7),0,0,6);this.addChild(this.shape);}
Hero.EXPLOSION_PIXEL_SIZE=8;Hero.EXPLOSION_DISTANCE=80;Hero.EXPLOSION_COUNT=10;Hero.prototype.dispose=function(){_super.prototype.dispose.call(this);this.keyboard=null;this.velocity=null;this.shape=null;};Hero.prototype.onFire=function(){if(this.animateFireMotion()==true){this.dispatchEvent(hero.HeroEvent.FIRE_BULLET,null);}};Hero.prototype.animateFireMotion=function(){if(this.shootAnimatePending==true){return false;}
this.shootAnimatePending=true;var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(createjs.Graphics.getRGB(255,0,0,1));gfx.drawCircle(0,0,this.size);gfx.endStroke();var animateShape=new createjs.Shape(gfx);animateShape.scaleX=0.2;animateShape.scaleY=0.2;this.addChild(animateShape);createjs.Sound.play(goldenratio.SoundType.LASER,createjs.Sound.INTERRUPT_NONE,0,0,0,0.3,0);createjs.Tween.get(animateShape).to({scaleX:1,scaleY:1},this.reloadSpeed).call(this.clearAnimationShape.bind(this,animateShape));return true;};Hero.prototype.die=function(){this.isAlive=false;this.uncache();this.removeAllChildren();this.dispatchEvent(hero.HeroEvent.DIE,null);createjs.Sound.play(goldenratio.SoundType.PLAYER_DIE);this.rotation=0;var separation=(360/Hero.EXPLOSION_COUNT)>>0;var angle=0;for(var i=0;i<Hero.EXPLOSION_COUNT;i++){var exp=new createjs.Shape();exp.graphics.setStrokeStyle(0);exp.graphics.beginFill(this.colorValue);exp.graphics.drawRect(0,0,Hero.EXPLOSION_PIXEL_SIZE,Hero.EXPLOSION_PIXEL_SIZE);exp.graphics.endFill();exp.graphics.endStroke();exp.regX=Hero.EXPLOSION_PIXEL_SIZE>>1;exp.regY=Hero.EXPLOSION_PIXEL_SIZE>>1;exp.cache(0,0,Hero.EXPLOSION_PIXEL_SIZE,Hero.EXPLOSION_PIXEL_SIZE);this.addChild(exp);var rad=angle*Math.PI/180;var dx=exp.x+Math.cos(rad)*Hero.EXPLOSION_DISTANCE;var dy=exp.y+Math.sin(rad)*Hero.EXPLOSION_DISTANCE;createjs.Tween.get(exp).to({x:dx,y:dy},300,createjs.Ease.linear).call(this.onExplosionComplete.bind(this,i));angle+=separation;}};Hero.prototype.onExplosionComplete=function(explosionCount){if(explosionCount==Hero.EXPLOSION_COUNT-1){console.log("Game Over");this.canRemove=true;}};Hero.prototype.onMissionComplete=function(){this.dispatchEvent(hero.HeroEvent.MISSION_COMPLETE,null);};Hero.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,this.size*2,this.size*2);};Hero.prototype.clearAnimationShape=function(animateShape){this.removeChild(animateShape);this.shootAnimatePending=false;};Hero.prototype.reduceHealth=function(value){this.healthValue-=value;this.dispatchEvent(hero.HeroEvent.PLAYER_HIT,null);createjs.Sound.play(goldenratio.SoundType.PLAYER_HIT);if(this.healthValue<=0){this.healthValue=0;this.die();}};Hero.prototype.getHealth=function(){return this.healthValue;};Hero.prototype.update=function(){if(this.isAlive==false){return;}
if(this.y<this.size){this.velocity.y=0;this.y=this.size;return;}
if(this.y>470){this.velocity.y=0;this.y=470;return;}
if(this.x<10){this.velocity.x=0;this.x=10;return;}
if(this.x>630){this.velocity.x=0;this.x=630;return;}
if(this.keyboard.isKeyPress(com.goldenratio.utils.KeyboardEnum.DOWN)){this.velocity.y+=this.speed;}else if(this.keyboard.isKeyPress(com.goldenratio.utils.KeyboardEnum.UP)){this.velocity.y-=this.speed;}else{this.velocity.y*=this.friction;}
if(this.keyboard.isKeyPress(com.goldenratio.utils.KeyboardEnum.LEFT)){this.velocity.x-=this.speed;}else if(this.keyboard.isKeyPress(com.goldenratio.utils.KeyboardEnum.RIGHT)){this.velocity.x+=this.speed;}else{this.velocity.x*=this.friction;}
if(this.keyboard.isKeyPress(com.goldenratio.utils.KeyboardEnum.Z)){this.onFire();}
this.x+=this.velocity.x;this.y+=this.velocity.y;if(this.velocity.x>this.maxSpeed){this.velocity.x=this.maxSpeed;}else if(this.velocity.x<-this.maxSpeed){this.velocity.x=-this.maxSpeed;}
if(this.velocity.y>this.maxSpeed){this.velocity.y=this.maxSpeed;}else if(this.velocity.y<-this.maxSpeed){this.velocity.y=-this.maxSpeed;}};return Hero;})(com.goldenratio.BasicDisplayObject);hero.Hero=Hero;})(goldenratio.hero||(goldenratio.hero={}));var hero=goldenratio.hero;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var BackgroundGrid=(function(_super){__extends(BackgroundGrid,_super);function BackgroundGrid(){_super.call(this);this.horizontalLines=[];this.verticalLines=[];this.lineSpeed=2;var i;var hy=80;for(i=0;i<6;i++){var gfx=new createjs.Graphics();gfx.setStrokeStyle(1);gfx.beginStroke(createjs.Graphics.getRGB(0,0,255,0.2));gfx.moveTo(0,0);gfx.lineTo(640,0);gfx.endStroke();var shape=new createjs.Shape(gfx);shape.x=0;shape.y=hy;shape.cache(0,0,640,2);hy+=80;this.addChild(shape);this.horizontalLines.push(shape);}
var vx=80;for(i=0;i<8;i++){var gfx=new createjs.Graphics();gfx.setStrokeStyle(1);gfx.beginStroke(createjs.Graphics.getRGB(0,0,255,0.3));gfx.moveTo(0,0);gfx.lineTo(0,480);gfx.endStroke();var shape=new createjs.Shape(gfx);shape.x=vx;shape.y=0;shape.cache(0,0,2,480);vx+=80;this.addChild(shape);this.verticalLines.push(shape);}}
BackgroundGrid.prototype.update=function(){for(var i=0;i<this.verticalLines.length;i++){var line=this.verticalLines[i];line.x-=this.lineSpeed;if(line.x<0){line.x=640;}}};BackgroundGrid.prototype.dispose=function(){this.uncache();this.removeAllChildren();this.horizontalLines=null;this.verticalLines=null;};return BackgroundGrid;})(createjs.Container);goldenratio.BackgroundGrid=BackgroundGrid;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(enums){var EnemyAnimationType=(function(){function EnemyAnimationType(){}
EnemyAnimationType.LINEAR="com.goldenratio.enemies.enums.EnemyAnimationType.LINEAR";EnemyAnimationType.L_DOWN="com.goldenratio.enemies.enums.EnemyAnimationType.L_DOWN";EnemyAnimationType.L_UP="com.goldenratio.enemies.enums.EnemyAnimationType.L_UP";EnemyAnimationType.CIRCLE="com.goldenratio.enemies.enums.EnemyAnimationType.CIRCLE";return EnemyAnimationType;})();enums.EnemyAnimationType=EnemyAnimationType;})(enemies.enums||(enemies.enums={}));var enums=enemies.enums;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(utils){var TimerEvent=(function(){function TimerEvent(){this.currentCount=0;}
TimerEvent.TIMER="com.goldenratio.utils.TimerEvent.TIMER";TimerEvent.TIMER_COMPLETE="com.goldenratio.utils.TimerEvent.Timer_Complete";return TimerEvent;})();utils.TimerEvent=TimerEvent;var Timer=(function(_super){__extends(Timer,_super);function Timer(delay,repeatCount){if(typeof repeatCount==="undefined"){repeatCount=0;}
_super.call(this);this.delay=delay;this.repeatCount=repeatCount;this.currentCount=0;this.running=false;this.isPaused=false;this.currentCount=0;}
Timer.prototype.dispose=function(){this.stop();};Timer.prototype.reset=function(){this.stop();this.start();};Timer.prototype.start=function(){if(this.running==true){console.log("timer already running!");return;}
console.log("start timer");if(this.isPaused==false){this.currentCount=0;}
this.running=true;this.isPaused=false;this.timerInterval=setInterval(this.onTimer.bind(this),this.delay);};Timer.prototype.stop=function(){clearInterval(this.timerInterval);this.timerInterval=null;this.currentCount=0;this.running=false;};Timer.prototype.pause=function(){console.log("pause timer");this.isPaused=true;clearInterval(this.timerInterval);this.running=false;};Timer.prototype.onTimer=function(){this.currentCount++;var event=new TimerEvent();if(this.currentCount>=this.repeatCount&&this.repeatCount!=0){event.type=TimerEvent.TIMER_COMPLETE;event.currentCount=this.currentCount;this.running=false;this.dispatchEvent(event,null);return;}
event.type=TimerEvent.TIMER;event.currentCount=this.currentCount;this.dispatchEvent(event,null);};return Timer;})(createjs.EventDispatcher);utils.Timer=Timer;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(bullets){var EnemyBulletType=(function(){function EnemyBulletType(){}
EnemyBulletType.HEXAGON="com.goldenratio.enemies.bullets.EnemyBulletType.HEXAGON";EnemyBulletType.TRIANGLE="com.goldenratio.enemies.bullets.EnemyBulletType.TRIANGLE";EnemyBulletType.SQUARE="com.goldenratio.enemies.bullets.EnemyBulletType.SQUARE";return EnemyBulletType;})();bullets.EnemyBulletType=EnemyBulletType;var EnemyBulletEvent=(function(){function EnemyBulletEvent(){}
EnemyBulletEvent.FIRE="com.goldenratio.enemies.bullets.EnemyBulletType.FIRE";return EnemyBulletEvent;})();bullets.EnemyBulletEvent=EnemyBulletEvent;})(enemies.bullets||(enemies.bullets={}));var bullets=enemies.bullets;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){var BaseEnemy=(function(_super){__extends(BaseEnemy,_super);function BaseEnemy(animationType){if(typeof animationType==="undefined"){animationType=enemies.enums.EnemyAnimationType.LINEAR;}
_super.call(this);this.animationType=animationType;this.scoreValue=50;this.canFire=false;this.isAlive=true;this.canRemove=false;this.autoRotate=false;this.hitsToKill=1;this.currentHits=0;this.damage=10;this.ROTATION_SPEED=10;this.secondDirection=false;this.degree=0;this.circleRadius=150;this.fireTimeCount=0;this.colorValue=createjs.Graphics.getRGB(255,255,255,0.8);}
BaseEnemy.EXPLOSION_PIXEL_SIZE=5;BaseEnemy.EXPLOSION_DISTANCE=60;BaseEnemy.EXPLOSION_COUNT=8;BaseEnemy.FIRE_RELOAD_TIME=25;BaseEnemy.prototype.dispose=function(){_super.prototype.dispose.call(this);if(this.tempPosition){this.tempPosition=null;}
if(this.flashHitShape){this.flashHitShape=null;}
if(this.flashHitTimer){if(this.onTimerCompleteBind){this.flashHitTimer.removeEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerCompleteBind);}
this.flashHitTimer.dispose();this.flashHitTimer=null;}
this.onTimerCompleteBind=null;};BaseEnemy.prototype.update=function(){if(this.isAlive==false){return;}
this.fireTimeCount++;if(this.canFire==true&&this.fireTimeCount==BaseEnemy.FIRE_RELOAD_TIME){this.fireTimeCount=0;var fireEvent=new enemies.bullets.EnemyBulletEvent();fireEvent.type=enemies.bullets.EnemyBulletEvent.FIRE;fireEvent.bulletType=this.bulletType;fireEvent.position=new createjs.Point(this.x,this.y);this.dispatchEvent(fireEvent,null);}
var tx=this.x;var ty=this.y;switch(this.animationType){case enemies.enums.EnemyAnimationType.LINEAR:tx-=8;break;case enemies.enums.EnemyAnimationType.L_DOWN:if(this.x<500&&this.secondDirection==false){tx+=8;ty+=4;}else{this.secondDirection=true;tx-=8;ty+=4;}
break;case enemies.enums.EnemyAnimationType.L_UP:if(this.x<500&&this.secondDirection==false){tx+=8;ty-=4;}else{this.secondDirection=true;tx-=8;ty-=4;}
break;case enemies.enums.EnemyAnimationType.CIRCLE:if(this.x>480&&this.secondDirection==false){tx-=8;ty+=4;}else if(this.degree<=500){if(this.secondDirection==false){this.tempPosition=new createjs.Point(this.x,this.y);}
this.secondDirection=true;var rad=this.degree*Math.PI/180;tx=(this.tempPosition.x-this.circleRadius)+Math.cos(rad)*this.circleRadius;ty=this.tempPosition.y+Math.sin(rad)*this.circleRadius;this.degree+=4;}else{tx-=8;ty-=8;}
break;}
if(this.autoRotate==true){var deltaY=this.y-ty;var deltaX=this.x-tx;this.rotation=(Math.atan2(deltaY,deltaX)*180)/Math.PI;}else{if(this.rotation<=0){this.rotation=360;}else{this.rotation-=this.ROTATION_SPEED;}}
this.x=tx;this.y=ty;};BaseEnemy.prototype.onTimerComplete=function(event){this.removeChild(this.flashHitShape);this.updateCache(null);this.flashHitTimer.dispose();this.flashHitTimer.removeEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerCompleteBind);this.onTimerCompleteBind=null;this.flashHitTimer=null;};BaseEnemy.prototype.flashHit=function(){if(this.flashHitTimer||this.flashHitShape==null){return;}
this.flashHitTimer=new com.goldenratio.utils.Timer(100,1);this.onTimerCompleteBind=this.onTimerComplete.bind(this);this.flashHitTimer.addEventListener(goldenratio.utils.TimerEvent.TIMER_COMPLETE,this.onTimerCompleteBind);this.addChild(this.flashHitShape);this.updateCache(null);this.flashHitTimer.start();createjs.Sound.play(goldenratio.SoundType.ENEMY_SINGLE_HIT);};BaseEnemy.prototype.die=function(immediately){if(typeof immediately==="undefined"){immediately=false;}
this.currentHits++;if((this.currentHits<this.hitsToKill)&&immediately==false){this.flashHit();return;}
this.uncache();this.removeAllChildren();this.rotation=0;this.isAlive=false;var separation=(360/BaseEnemy.EXPLOSION_COUNT)>>0;var angle=0;for(var i=0;i<BaseEnemy.EXPLOSION_COUNT;i++){var exp=new createjs.Shape();exp.graphics.setStrokeStyle(0);exp.graphics.beginFill(this.colorValue);exp.graphics.drawRect(0,0,BaseEnemy.EXPLOSION_PIXEL_SIZE,BaseEnemy.EXPLOSION_PIXEL_SIZE);exp.graphics.endFill();exp.graphics.endStroke();exp.regX=BaseEnemy.EXPLOSION_PIXEL_SIZE>>1;exp.regY=BaseEnemy.EXPLOSION_PIXEL_SIZE>>1;exp.x=this.getBounds().width>>1;exp.y=this.getBounds().width>>1;exp.cache(0,0,BaseEnemy.EXPLOSION_PIXEL_SIZE,BaseEnemy.EXPLOSION_PIXEL_SIZE);this.addChild(exp);var rad=angle*Math.PI/180;var dx=exp.x+Math.cos(rad)*BaseEnemy.EXPLOSION_DISTANCE;var dy=exp.y+Math.sin(rad)*BaseEnemy.EXPLOSION_DISTANCE;createjs.Sound.play(goldenratio.SoundType.ENEMY_HIT);createjs.Tween.get(exp).to({x:dx,y:dy},300,createjs.Ease.linear).call(this.onExplosionComplete.bind(this,i));angle+=separation;}};BaseEnemy.prototype.onExplosionComplete=function(explosionCount){if(explosionCount==BaseEnemy.EXPLOSION_COUNT-1){this.canRemove=true;}};return BaseEnemy;})(com.goldenratio.BasicDisplayObject);enemies.BaseEnemy=BaseEnemy;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){var SquareEnemy=(function(_super){__extends(SquareEnemy,_super);function SquareEnemy(animationType){if(typeof animationType==="undefined"){animationType=enemies.enums.EnemyAnimationType.LINEAR;}
_super.call(this,animationType);this.scoreValue=50;this.hitsToKill=1;this.currentHits=0;this.damage=20;this.bulletType=enemies.bullets.EnemyBulletType.SQUARE;this.colorValue=createjs.Graphics.getRGB(0,255,0,0.8);var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(this.colorValue);gfx.moveTo(0,0);gfx.lineTo(0,SquareEnemy.SIZE);gfx.lineTo(SquareEnemy.SIZE,SquareEnemy.SIZE);gfx.lineTo(SquareEnemy.SIZE,0);gfx.lineTo(0,0);gfx.endStroke();var shape=new createjs.Shape(gfx);this.addChild(shape);this.regX=SquareEnemy.SIZE>>1;this.regY=SquareEnemy.SIZE>>1;this.cache(-1,-1,SquareEnemy.SIZE+2,SquareEnemy.SIZE+2);this.ROTATION_SPEED=10;if(this.animationType==enemies.enums.EnemyAnimationType.L_DOWN||this.animationType==enemies.enums.EnemyAnimationType.L_UP||this.animationType==enemies.enums.EnemyAnimationType.CIRCLE){this.ROTATION_SPEED=20;}}
SquareEnemy.SIZE=20;SquareEnemy.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,SquareEnemy.SIZE,SquareEnemy.SIZE);};SquareEnemy.prototype.dispose=function(){_super.prototype.dispose.call(this);};SquareEnemy.prototype.update=function(){_super.prototype.update.call(this);};return SquareEnemy;})(com.goldenratio.enemies.BaseEnemy);enemies.SquareEnemy=SquareEnemy;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){var HexagonEnemy=(function(_super){__extends(HexagonEnemy,_super);function HexagonEnemy(animationType){if(typeof animationType==="undefined"){animationType=enemies.enums.EnemyAnimationType.LINEAR;}
_super.call(this,animationType);this.scoreValue=100;this.hitsToKill=1;this.currentHits=0;this.damage=20;this.bulletType=enemies.bullets.EnemyBulletType.HEXAGON;this.colorValue=createjs.Graphics.getRGB(103,204,255,0.8);var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(this.colorValue);gfx.moveTo(HexagonEnemy.SIZE,0);var degree=0;for(var i=0;i<7;i++){var radians=degree*Math.PI/180;var hx=Math.cos(radians)*HexagonEnemy.SIZE;var hy=Math.sin(radians)*HexagonEnemy.SIZE;degree+=60;gfx.lineTo(hx,hy);}
gfx.endStroke();var shape=new createjs.Shape(gfx);shape.x=HexagonEnemy.SIZE;shape.y=HexagonEnemy.SIZE;this.addChild(shape);this.flashHitShape=shape.clone(false);this.flashHitShape.filters=[new createjs.ColorFilter(0,0,0,1,255,255,255,0.8)];this.flashHitShape.cache(-HexagonEnemy.SIZE,-HexagonEnemy.SIZE,(HexagonEnemy.SIZE*2)+2,HexagonEnemy.SIZE*2);this.regX=(HexagonEnemy.SIZE*2)>>1;this.regY=(HexagonEnemy.SIZE*2)>>1;this.cache(-1,-1,(HexagonEnemy.SIZE*2)+2,HexagonEnemy.SIZE*2);this.ROTATION_SPEED=12;if(this.animationType==enemies.enums.EnemyAnimationType.L_DOWN||this.animationType==enemies.enums.EnemyAnimationType.L_UP){this.ROTATION_SPEED=20;}}
HexagonEnemy.SIZE=14;HexagonEnemy.prototype.dispose=function(){_super.prototype.dispose.call(this);};HexagonEnemy.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,HexagonEnemy.SIZE*2,HexagonEnemy.SIZE*2);};HexagonEnemy.prototype.update=function(){_super.prototype.update.call(this);};return HexagonEnemy;})(com.goldenratio.enemies.BaseEnemy);enemies.HexagonEnemy=HexagonEnemy;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){var TriangleEnemy=(function(_super){__extends(TriangleEnemy,_super);function TriangleEnemy(animationType){if(typeof animationType==="undefined"){animationType=enemies.enums.EnemyAnimationType.LINEAR;}
_super.call(this,animationType);this.scoreValue=150;this.hitsToKill=2;this.currentHits=0;this.damage=20;this.autoRotate=true;this.bulletType=enemies.bullets.EnemyBulletType.TRIANGLE;this.colorValue=createjs.Graphics.getRGB(255,255,0,0.8);var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(this.colorValue);gfx.moveTo(0,0);gfx.lineTo(TriangleEnemy.SIZE,-(TriangleEnemy.SIZE>>1));gfx.lineTo(TriangleEnemy.SIZE,TriangleEnemy.SIZE>>1);gfx.lineTo(0,0);gfx.endStroke();var shape=new createjs.Shape(gfx);shape.x=0;shape.y=TriangleEnemy.SIZE>>1;this.addChild(shape);this.flashHitShape=shape.clone(false);this.flashHitShape.filters=[new createjs.ColorFilter(0,0,0,1,255,255,255,0.8)];this.flashHitShape.cache(-TriangleEnemy.SIZE,-TriangleEnemy.SIZE,(TriangleEnemy.SIZE*2)+2,TriangleEnemy.SIZE*2);this.regX=TriangleEnemy.SIZE>>1;this.regY=TriangleEnemy.SIZE>>1;this.cache(-1,-1,TriangleEnemy.SIZE+2,TriangleEnemy.SIZE+2);}
TriangleEnemy.SIZE=20;TriangleEnemy.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,TriangleEnemy.SIZE,TriangleEnemy.SIZE);};TriangleEnemy.prototype.dispose=function(){_super.prototype.dispose.call(this);};TriangleEnemy.prototype.update=function(){_super.prototype.update.call(this);};return TriangleEnemy;})(com.goldenratio.enemies.BaseEnemy);enemies.TriangleEnemy=TriangleEnemy;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(bullets){var EnemyBullet=(function(_super){__extends(EnemyBullet,_super);function EnemyBullet(targetPos,selfPos){_super.call(this);this.targetPos=targetPos;this.selfPos=selfPos;this.isAlive=true;this.canRemove=false;this.damageFromAmmo=5;this.size=new createjs.Rectangle(0,0,3,3);if(this.colorValue==null){this.colorValue=createjs.Graphics.getRGB(103,204,255,0.8);}
var gfx=new createjs.Graphics();gfx.setStrokeStyle(1);gfx.beginStroke(this.colorValue);gfx.drawCircle(0,0,this.size.width);gfx.endStroke();var shape=new createjs.Shape(gfx);shape.x=this.size.width;shape.y=this.size.height;shape.shadow=new createjs.Shadow(this.colorValue,0,0,5);this.addChild(shape);this.regX=(this.size.width)>>1;this.regY=(this.size.height)>>1;this.cache(-this.size.width>>1,-this.size.height>>1,(this.size.width*2)*2,(this.size.height*2)*2);var deltaY=selfPos.y-targetPos.y;var deltaX=selfPos.x-targetPos.x;this.directionInRad=Math.atan2(deltaY,deltaX);}
EnemyBullet.EXPLOSION_PIXEL_SIZE=4;EnemyBullet.EXPLOSION_DISTANCE=30;EnemyBullet.EXPLOSION_COUNT=6;EnemyBullet.SPEED=12;EnemyBullet.prototype.dispose=function(){_super.prototype.dispose.call(this);this.targetPos=null;this.selfPos=null;this.size=null;};EnemyBullet.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,this.size.width*2,this.size.width*2);};EnemyBullet.prototype.die=function(){this.uncache();this.removeAllChildren();this.isAlive=false;var separation=(360/EnemyBullet.EXPLOSION_COUNT)>>0;var angle=0;for(var i=0;i<EnemyBullet.EXPLOSION_COUNT;i++){var exp=new createjs.Shape();exp.graphics.setStrokeStyle(0);exp.graphics.beginFill(this.colorValue);exp.graphics.drawRect(0,0,EnemyBullet.EXPLOSION_PIXEL_SIZE,EnemyBullet.EXPLOSION_PIXEL_SIZE);exp.graphics.endFill();exp.graphics.endStroke();exp.regX=EnemyBullet.EXPLOSION_PIXEL_SIZE>>1;exp.regY=EnemyBullet.EXPLOSION_PIXEL_SIZE>>1;exp.x=this.getBounds().width>>1;exp.y=this.getBounds().width>>1;exp.cache(0,0,EnemyBullet.EXPLOSION_PIXEL_SIZE,EnemyBullet.EXPLOSION_PIXEL_SIZE);this.addChild(exp);var rad=angle*Math.PI/180;var dx=exp.x+Math.cos(rad)*EnemyBullet.EXPLOSION_DISTANCE;var dy=exp.y+Math.sin(rad)*EnemyBullet.EXPLOSION_DISTANCE;createjs.Tween.get(exp).to({x:dx,y:dy},200,createjs.Ease.linear).call(this.onExplosionComplete.bind(this,i));angle+=separation;}};EnemyBullet.prototype.onExplosionComplete=function(explosionCount){if(explosionCount==EnemyBullet.EXPLOSION_COUNT-1){this.canRemove=true;}};EnemyBullet.prototype.update=function(){if(this.isAlive==false){return;}
this.x-=Math.cos(this.directionInRad)*EnemyBullet.SPEED;this.y-=Math.sin(this.directionInRad)*EnemyBullet.SPEED;};return EnemyBullet;})(com.goldenratio.BasicDisplayObject);bullets.EnemyBullet=EnemyBullet;})(enemies.bullets||(enemies.bullets={}));var bullets=enemies.bullets;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(bullets){var HexagonBullet=(function(_super){__extends(HexagonBullet,_super);function HexagonBullet(targetPos,selfPos){this.colorValue=createjs.Graphics.getRGB(103,204,255,1);_super.call(this,targetPos,selfPos);}
HexagonBullet.prototype.dispose=function(){_super.prototype.dispose.call(this);};HexagonBullet.prototype.update=function(){_super.prototype.update.call(this);};return HexagonBullet;})(bullets.EnemyBullet);bullets.HexagonBullet=HexagonBullet;})(enemies.bullets||(enemies.bullets={}));var bullets=enemies.bullets;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(bullets){var TriangleBullet=(function(_super){__extends(TriangleBullet,_super);function TriangleBullet(targetPos,selfPos){this.colorValue=createjs.Graphics.getRGB(255,255,0,0.8);_super.call(this,targetPos,selfPos);}
TriangleBullet.prototype.dispose=function(){_super.prototype.dispose.call(this);};TriangleBullet.prototype.update=function(){_super.prototype.update.call(this);};return TriangleBullet;})(bullets.EnemyBullet);bullets.TriangleBullet=TriangleBullet;})(enemies.bullets||(enemies.bullets={}));var bullets=enemies.bullets;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(bullets){var SquareBullet=(function(_super){__extends(SquareBullet,_super);function SquareBullet(targetPos,selfPos){this.colorValue=createjs.Graphics.getRGB(0,255,0,0.8);_super.call(this,targetPos,selfPos);}
SquareBullet.prototype.dispose=function(){_super.prototype.dispose.call(this);};SquareBullet.prototype.update=function(){_super.prototype.update.call(this);};return SquareBullet;})(bullets.EnemyBullet);bullets.SquareBullet=SquareBullet;})(enemies.bullets||(enemies.bullets={}));var bullets=enemies.bullets;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(utils){var BrowserType=(function(){function BrowserType(){}
BrowserType.isFirefox=function isFirefox(){if(window["InstallTrigger"]){return typeof window["InstallTrigger"]!=='undefined';}
return false;};BrowserType.isOpera=function isOpera(){return!!window["opera"]||navigator.userAgent.indexOf(' OPR/')>=0;};BrowserType.isChrome=function isChrome(){return!!window["chrome"]&&!BrowserType.isOpera();};BrowserType.isIE=function isIE(){return false||document.documentMode;};BrowserType.isSafari=function isSafari(){return Object.prototype.toString.call(window["HTMLElement"]).indexOf('Constructor')>0;};return BrowserType;})();utils.BrowserType=BrowserType;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(texts){var Score=(function(){function Score(stage){this.stage=stage;this.value=0;}
Score.prototype.dispose=function(){if(this.scoreText){this.stage.removeChild(this.scoreText);this.scoreText=null;}
this.stage=null;};Score.prototype.init=function(){this.scoreText=new createjs.Text("00000","18px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.scoreText.x=10;this.scoreText.y=10;this.stage.addChild(this.scoreText);this.updateScore();};Score.prototype.add=function(data){this.value+=data;this.updateScore();};Score.prototype.updateScore=function(){var prefix="";if(this.value<10){prefix="0000";}else if(this.value<100){prefix="000";}else if(this.value<1000){prefix="00";}else if(this.value<10000){prefix="0";}
this.scoreText.text=prefix+this.value.toString();};return Score;})();texts.Score=Score;})(goldenratio.texts||(goldenratio.texts={}));var texts=goldenratio.texts;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(enums){var EnemyType=(function(){function EnemyType(){}
EnemyType.SQUARE="com.goldenratio.enemies.EnemyType.enums.SQUARE";EnemyType.TRIANGLE="com.goldenratio.enemies.EnemyType.enums.TRIANGLE";EnemyType.HEXAGON="com.goldenratio.enemies.EnemyType.enums.HEXAGON";EnemyType.MISSION_COMPLETE="com.goldenratio.enemies.EnemyType.enums.MISSION_COMPLETE";return EnemyType;})();enums.EnemyType=EnemyType;})(enemies.enums||(enemies.enums={}));var enums=enemies.enums;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){(function(enums){var MapData=(function(){function MapData(enemyType,time,position,animationType,canFire){if(typeof canFire==="undefined"){canFire=false;}
this.enemyType=enemyType;this.time=time;this.position=position;this.animationType=animationType;this.canFire=canFire;}
return MapData;})();enums.MapData=MapData;var SpawnMap=(function(){function SpawnMap(){}
SpawnMap.map=[new MapData(enums.EnemyType.SQUARE,5,new createjs.Point(700,100),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.SQUARE,12,new createjs.Point(700,200),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.SQUARE,14,new createjs.Point(700,200),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.SQUARE,16,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.SQUARE,18,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.SQUARE,28,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,30,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,38,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,40,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,56,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.SQUARE,58,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.SQUARE,66,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,68,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.SQUARE,78,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,80,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.SQUARE,90,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,92,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,94,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.SQUARE,96,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,98,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,102,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,104,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,106,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.SQUARE,108,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.SQUARE,110,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,126,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.HEXAGON,128,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.HEXAGON,130,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.HEXAGON,132,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.HEXAGON,166,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.HEXAGON,168,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.HEXAGON,170,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.HEXAGON,172,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.HEXAGON,174,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,176,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,178,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.HEXAGON,180,new createjs.Point(100,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,200,new createjs.Point(700,100),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,204,new createjs.Point(700,150),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,208,new createjs.Point(700,200),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,212,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,216,new createjs.Point(700,300),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,220,new createjs.Point(700,350),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,224,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,236,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,240,new createjs.Point(700,350),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,244,new createjs.Point(700,300),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,248,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,252,new createjs.Point(700,200),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,256,new createjs.Point(700,150),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,260,new createjs.Point(700,100),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.HEXAGON,272,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.HEXAGON,274,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE,true),new MapData(enums.EnemyType.SQUARE,292,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.SQUARE,294,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE,true),new MapData(enums.EnemyType.HEXAGON,332,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,334,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,336,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,338,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,340,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,342,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,344,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,346,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,348,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,350,new createjs.Point(200,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.SQUARE,352,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,354,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.HEXAGON,374,new createjs.Point(700,150),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.HEXAGON,376,new createjs.Point(700,150),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.HEXAGON,380,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.HEXAGON,382,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.HEXAGON,384,new createjs.Point(700,350),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.HEXAGON,386,new createjs.Point(700,350),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.TRIANGLE,400,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,402,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.TRIANGLE,404,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,410,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,412,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.TRIANGLE,414,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,430,new createjs.Point(700,100),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.TRIANGLE,432,new createjs.Point(700,100),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.TRIANGLE,436,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.TRIANGLE,438,new createjs.Point(700,250),enums.EnemyAnimationType.LINEAR,true),new MapData(enums.EnemyType.TRIANGLE,442,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.TRIANGLE,444,new createjs.Point(700,400),enums.EnemyAnimationType.LINEAR),new MapData(enums.EnemyType.TRIANGLE,460,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,462,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,464,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE,true),new MapData(enums.EnemyType.TRIANGLE,466,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,468,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,470,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,472,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE,true),new MapData(enums.EnemyType.TRIANGLE,474,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,476,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,478,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE,true),new MapData(enums.EnemyType.TRIANGLE,480,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,482,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,484,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,486,new createjs.Point(700,100),enums.EnemyAnimationType.CIRCLE),new MapData(enums.EnemyType.TRIANGLE,550,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,552,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,554,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,556,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.TRIANGLE,558,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,560,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,562,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,564,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN,true),new MapData(enums.EnemyType.TRIANGLE,566,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,568,new createjs.Point(100,-60),enums.EnemyAnimationType.L_DOWN),new MapData(enums.EnemyType.TRIANGLE,576,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,578,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,580,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.TRIANGLE,582,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,584,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,586,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.TRIANGLE,588,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,590,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.TRIANGLE,592,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP,true),new MapData(enums.EnemyType.TRIANGLE,594,new createjs.Point(200,500),enums.EnemyAnimationType.L_UP),new MapData(enums.EnemyType.MISSION_COMPLETE,660,null,null)];return SpawnMap;})();enums.SpawnMap=SpawnMap;})(enemies.enums||(enemies.enums={}));var enums=enemies.enums;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(utils){var CollisionDetection=(function(){function CollisionDetection(){}
CollisionDetection.isColliding=function isColliding(target1,target2){return(Math.abs(target1.getBounds().x-target2.getBounds().x)*2<(target1.getBounds().width+target2.getBounds().width))&&(Math.abs(target1.getBounds().y-target2.getBounds().y)*2<(target1.getBounds().height+target2.getBounds().height));};return CollisionDetection;})();utils.CollisionDetection=CollisionDetection;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(enemies){var EnemyManager=(function(){function EnemyManager(stage,hero,bulletList,score){this.stage=stage;this.hero=hero;this.bulletList=bulletList;this.score=score;this.enemyList=[];this.enemyBulletList=[];this.currentMapCount=0;this.bulletBoundaries=new createjs.Rectangle(-50,-50,700,530);}
EnemyManager.prototype.dispose=function(){if(this.spawnTimer){this.spawnTimer.stop();this.spawnTimer.removeEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerHandlerBind);this.spawnTimer=null;}
if(this.enemyList){for(var i=this.enemyList.length-1;i>=0;i--){this.enemyList[i].dispose();this.enemyList[i].removeEventListener(enemies.bullets.EnemyBulletEvent.FIRE,this.onEnemyFireBind);this.enemyList[i]=null;this.enemyList.splice(i,1);}
this.enemyList=null;}
if(this.enemyBulletList){for(var j=this.enemyBulletList.length-1;j>=0;j--){this.enemyBulletList[j].dispose();this.enemyBulletList[j]=null;this.enemyBulletList.splice(j,1);}}
if(this.hero){this.hero=null;}
if(this.bulletList){for(var k=0;k<this.bulletList.length;k++){this.bulletList[k].dispose();this.bulletList[k]=null;}
this.bulletList.length=0;this.bulletList=null;}
this.onEnemyFireBind=null;this.onTimerHandlerBind=null;this.score=null;this.stage=null;};EnemyManager.prototype.init=function(){this.onTimerHandlerBind=this.onTimerHandler.bind(this);this.onEnemyFireBind=this.onEnemyFire.bind(this);this.spawnTimer=new com.goldenratio.utils.Timer(100);this.spawnTimer.addEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerHandlerBind);this.spawnTimer.start();};EnemyManager.prototype.onTimerHandler=function(event){for(var i=this.currentMapCount;i<enemies.enums.SpawnMap.map.length;i++){if(event.currentCount==enemies.enums.SpawnMap.map[i].time){this.spawnEnemy(enemies.enums.SpawnMap.map[i]);this.currentMapCount++;}else{break;}}};EnemyManager.prototype.spawnEnemy=function(data){switch(data.enemyType){case enemies.enums.EnemyType.SQUARE:var square=new enemies.SquareEnemy(data.animationType);square.addEventListener(enemies.bullets.EnemyBulletEvent.FIRE,this.onEnemyFireBind);square.x=data.position.x;square.y=data.position.y;square.canFire=data.canFire;this.stage.addChild(square);this.enemyList.push(square);break;case enemies.enums.EnemyType.HEXAGON:var hexagon=new enemies.HexagonEnemy(data.animationType);hexagon.addEventListener(enemies.bullets.EnemyBulletEvent.FIRE,this.onEnemyFireBind);hexagon.x=data.position.x;hexagon.y=data.position.y;hexagon.canFire=data.canFire;this.stage.addChild(hexagon);this.enemyList.push(hexagon);break;case enemies.enums.EnemyType.TRIANGLE:var triangle=new enemies.TriangleEnemy(data.animationType);triangle.addEventListener(enemies.bullets.EnemyBulletEvent.FIRE,this.onEnemyFireBind);triangle.x=data.position.x;triangle.y=data.position.y;triangle.canFire=data.canFire;this.stage.addChild(triangle);this.enemyList.push(triangle);break;case enemies.enums.EnemyType.MISSION_COMPLETE:this.hero.onMissionComplete();break;}};EnemyManager.prototype.onEnemyFire=function(event){var tempBullet;switch(event.bulletType){case enemies.bullets.EnemyBulletType.HEXAGON:tempBullet=new enemies.bullets.HexagonBullet(new createjs.Point(this.hero.x,this.hero.y),event.position);tempBullet.x=event.position.x;tempBullet.y=event.position.y;this.stage.addChild(tempBullet);this.enemyBulletList.push(tempBullet);break;case enemies.bullets.EnemyBulletType.TRIANGLE:tempBullet=new enemies.bullets.TriangleBullet(new createjs.Point(this.hero.x,this.hero.y),event.position);tempBullet.x=event.position.x;tempBullet.y=event.position.y;this.stage.addChild(tempBullet);this.enemyBulletList.push(tempBullet);break;case enemies.bullets.EnemyBulletType.SQUARE:tempBullet=new enemies.bullets.SquareBullet(new createjs.Point(this.hero.x,this.hero.y),event.position);tempBullet.x=event.position.x;tempBullet.y=event.position.y;this.stage.addChild(tempBullet);this.enemyBulletList.push(tempBullet);break;}};EnemyManager.prototype.togglePause=function(){if(createjs.Ticker.getPaused()==true){this.spawnTimer.pause();}else{this.spawnTimer.start();}};EnemyManager.prototype.stopSpawn=function(){if(this.spawnTimer){this.spawnTimer.stop();}};EnemyManager.prototype.update=function(){var j;var i;for(i=this.enemyList.length-1;i>=0;i--){if(this.enemyList[i].isAlive==true){this.enemyList[i].update();}
if(this.hero){if(this.enemyList[i].isAlive==true&&this.hero.isAlive==true){if(com.goldenratio.utils.CollisionDetection.isColliding(this.hero,this.enemyList[i])){console.log("player dies");this.enemyList[i].die(true);this.hero.reduceHealth(this.enemyList[i].damage);}
for(j=this.bulletList.length-1;j>=0;j--){if(com.goldenratio.utils.CollisionDetection.isColliding(this.bulletList[j],this.enemyList[i])&&this.bulletList[j].isAlive==true){console.log("hit");this.bulletList[j].die();this.enemyList[i].die();this.score.add(this.enemyList[i].scoreValue);}}}}
if(this.enemyList[i].x<-this.enemyList[i].getBounds().width||this.enemyList[i].canRemove==true){if(this.enemyList[i]){this.enemyList[i].dispose();this.enemyList[i].removeEventListener(enemies.bullets.EnemyBulletEvent.FIRE,this.onEnemyFireBind);this.stage.removeChild(this.enemyList[i]);this.enemyList[i]=null;this.enemyList.splice(i,1);}}}
for(i=this.bulletList.length-1;i>=0;i--){if(this.bulletList[i].canRemove==true){this.bulletList[i].dispose();this.stage.removeChild(this.bulletList[i]);this.bulletList[i]=null;this.bulletList.splice(i,1);}}
for(i=this.enemyBulletList.length-1;i>=0;i--){if(this.enemyBulletList[i].isAlive==true){this.enemyBulletList[i].update();}
if(this.hero){if(this.hero.isAlive==true&&this.enemyBulletList[i].isAlive==true){if(com.goldenratio.utils.CollisionDetection.isColliding(this.enemyBulletList[i],this.hero)){this.enemyBulletList[i].die();this.hero.reduceHealth(this.enemyBulletList[i].damageFromAmmo);}}}
if(this.enemyBulletList[i].x>this.bulletBoundaries.width||this.enemyBulletList[i].x<this.bulletBoundaries.x||this.enemyBulletList[i].y>this.bulletBoundaries.height||this.enemyBulletList[i].y<this.bulletBoundaries.y||this.enemyBulletList[i].canRemove){this.enemyBulletList[i].dispose();this.stage.removeChild(this.enemyBulletList[i]);this.enemyBulletList[i]=null;this.enemyBulletList.splice(i,1);}}};return EnemyManager;})();enemies.EnemyManager=EnemyManager;})(goldenratio.enemies||(goldenratio.enemies={}));var enemies=goldenratio.enemies;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var Bullet=(function(_super){__extends(Bullet,_super);function Bullet(){_super.call(this);this.speed=20;this.canRemove=false;this.isAlive=true;this.size=new createjs.Rectangle(0,0,15,5);this.colorValue=createjs.Graphics.getRGB(255,0,0,1);var gfx=new createjs.Graphics();gfx.setStrokeStyle(this.size.height);gfx.beginStroke(this.colorValue);gfx.moveTo(0,0);gfx.lineTo(this.size.width,0);gfx.endStroke();var shape=new createjs.Shape(gfx);shape.shadow=new createjs.Shadow(createjs.Graphics.getRGB(255,0,0,0.6),0,0,6);this.addChild(shape);this.cache(0,-this.size.height,this.size.width,this.size.height*2);}
Bullet.EXPLOSION_PIXEL_SIZE=4;Bullet.EXPLOSION_DISTANCE=30;Bullet.EXPLOSION_COUNT=6;Bullet.prototype.dispose=function(){this.size=null;_super.prototype.dispose.call(this);};Bullet.prototype.update=function(){if(this.isAlive==false){return;}
this.x+=this.speed;};Bullet.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,this.size.width,this.size.height);};Bullet.prototype.die=function(){this.isAlive=false;this.uncache();this.removeAllChildren();var separation=(360/Bullet.EXPLOSION_COUNT)>>0;var angle=0;for(var i=0;i<Bullet.EXPLOSION_COUNT;i++){var exp=new createjs.Shape();exp.graphics.setStrokeStyle(0);exp.graphics.beginFill(this.colorValue);exp.graphics.drawRect(0,0,Bullet.EXPLOSION_PIXEL_SIZE,Bullet.EXPLOSION_PIXEL_SIZE);exp.graphics.endFill();exp.graphics.endStroke();exp.regX=Bullet.EXPLOSION_PIXEL_SIZE>>1;exp.regY=Bullet.EXPLOSION_PIXEL_SIZE>>1;exp.x=this.getBounds().width>>1;exp.y=this.getBounds().width>>1;exp.cache(0,0,Bullet.EXPLOSION_PIXEL_SIZE,Bullet.EXPLOSION_PIXEL_SIZE);this.addChild(exp);var rad=angle*Math.PI/180;var dx=exp.x+Math.cos(rad)*Bullet.EXPLOSION_DISTANCE;var dy=exp.y+Math.sin(rad)*Bullet.EXPLOSION_DISTANCE;createjs.Tween.get(exp).to({x:dx,y:dy},200,createjs.Ease.linear).call(this.onExplosionComplete.bind(this,i));angle+=separation;}};Bullet.prototype.onExplosionComplete=function(explosionCount){if(explosionCount==Bullet.EXPLOSION_COUNT-1){this.canRemove=true;}};return Bullet;})(com.goldenratio.BasicDisplayObject);goldenratio.Bullet=Bullet;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(elements){var HealthBar=(function(_super){__extends(HealthBar,_super);function HealthBar(){_super.call(this);this.size=new createjs.Rectangle(0,0,200,15);var shape=new createjs.Shape();shape.graphics.setStrokeStyle(1);shape.graphics.beginStroke(createjs.Graphics.getRGB(255,255,255,0.8));shape.graphics.drawRect(0,0,this.size.width,this.size.height);shape.graphics.endStroke();this.addChild(shape);this.bar=new createjs.Shape();this.addChild(this.bar);this.cache(-1,-1,this.size.width+2,this.size.height+2);}
HealthBar.prototype.getBounds=function(){return new createjs.Rectangle(this.x,this.y,this.size.width,this.size.height);};HealthBar.prototype.dispose=function(){_super.prototype.dispose.call(this);this.bar=null;this.size=null;};HealthBar.prototype.setValue=function(value){this.bar.graphics.clear();if(value<0){value=0;}
var pct=((value/100)*this.size.width)>>0;if(pct>0){this.bar.graphics.beginFill(createjs.Graphics.getRGB(255,255,255,0.8));this.bar.graphics.drawRect(3,3,pct-6,this.size.height-6);this.bar.graphics.endFill();}
this.updateCache(null);};HealthBar.prototype.update=function(){};return HealthBar;})(com.goldenratio.BasicDisplayObject);elements.HealthBar=HealthBar;})(goldenratio.elements||(goldenratio.elements={}));var elements=goldenratio.elements;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(elements){var RedScreen=(function(_super){__extends(RedScreen,_super);function RedScreen(){_super.call(this);this.speed=200;this.centerHoleSize=800;this.centerHolePosition=new createjs.Point(310,230);}
RedScreen.prototype.dispose=function(){_super.prototype.dispose.call(this);this.centerHolePosition=null;this.gfx=null;};RedScreen.prototype.show=function(){if(this.gfx){return;}
this.gfx=new createjs.Shape();this.gfx.graphics.beginRadialGradientFill([createjs.Graphics.getRGB(0,0,0,0),createjs.Graphics.getRGB(255,0,0,0.6)],[0.1,0.9],this.centerHolePosition.x,this.centerHolePosition.y,0,this.centerHolePosition.x,this.centerHolePosition.y,this.centerHoleSize);this.gfx.graphics.drawRect(0,0,640,480);this.gfx.graphics.endFill();this.addChild(this.gfx);createjs.Tween.get(this.gfx).to({alpha:1},this.speed,createjs.Ease.linear).call(this.hide.bind(this));};RedScreen.prototype.hide=function(){createjs.Tween.get(this.gfx).to({alpha:0},this.speed,createjs.Ease.linear).call(this.remove.bind(this));};RedScreen.prototype.remove=function(){if(this.gfx){this.gfx.graphics.clear();this.removeChild(this.gfx);this.gfx=null;}};RedScreen.prototype.update=function(){};return RedScreen;})(com.goldenratio.BasicDisplayObject);elements.RedScreen=RedScreen;})(goldenratio.elements||(goldenratio.elements={}));var elements=goldenratio.elements;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var RES=(function(){function RES(){}
RES.init=function init(queueData){RES.queue=queueData;};RES.get=function get(id){return RES.queue.getResult(id);};return RES;})();goldenratio.RES=RES;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(elements){var MuteIcon=(function(_super){__extends(MuteIcon,_super);function MuteIcon(){_super.call(this);this.gfx=new createjs.Bitmap(goldenratio.RES.get(goldenratio.GraphicsType.MUTE));this.addChild(this.gfx);this.show(false);}
MuteIcon.prototype.dispose=function(){_super.prototype.dispose.call(this);this.gfx=null;};MuteIcon.prototype.show=function(flag){if(typeof flag==="undefined"){flag=true;}
if(this.gfx){this.gfx.visible=flag;}};return MuteIcon;})(com.goldenratio.BasicDisplayObject);elements.MuteIcon=MuteIcon;})(goldenratio.elements||(goldenratio.elements={}));var elements=goldenratio.elements;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(screens){var GameOverScreen=(function(){function GameOverScreen(stage){this.stage=stage;this.isGameOver=false;}
GameOverScreen.prototype.dispose=function(){if(this.text){this.stage.removeChild(this.text);this.text=null;}
if(this.text){this.stage.removeChild(this.continueGameText);this.continueGameText=null;}
this.stage=null;};GameOverScreen.prototype.show=function(){this.isGameOver=true;this.text=new createjs.Text("GAME OVER","90px slickscreen",createjs.Graphics.getRGB(255,0,0,1));this.text.shadow=new createjs.Shadow(createjs.Graphics.getRGB(247,15,15,1),0,0,6);this.text.alpha=0;this.stage.addChild(this.text);this.text.x=35;this.text.y=180;createjs.Tween.get(this.text).to({alpha:1},1000,createjs.Ease.linear).call(this.onComplete.bind(this));};GameOverScreen.prototype.showMissionComplete=function(){this.isGameOver=true;this.text=new createjs.Text("  MISSION  \nCOMPLETE","90px slickscreen",createjs.Graphics.getRGB(0,255,0,1));this.text.textAlign="center";this.text.shadow=new createjs.Shadow(createjs.Graphics.getRGB(107,247,69,1),0,0,6);this.text.alpha=0;this.stage.addChild(this.text);this.text.x=320;this.text.y=100;createjs.Tween.get(this.text).to({alpha:1},1000,createjs.Ease.linear).call(this.onComplete.bind(this));};GameOverScreen.prototype.onComplete=function(){this.continueGameText=new createjs.Text("click to continue!","16px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.continueGameText.x=220;this.continueGameText.y=350;this.stage.addChild(this.continueGameText);};GameOverScreen.prototype.update=function(){};return GameOverScreen;})();screens.GameOverScreen=GameOverScreen;})(goldenratio.screens||(goldenratio.screens={}));var screens=goldenratio.screens;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(texts){var PausedText=(function(){function PausedText(stage){this.stage=stage;}
PausedText.prototype.dispose=function(){this.clear();this.stage=null;};PausedText.prototype.show=function(){this.shape=new createjs.Shape();this.shape.graphics.beginFill(createjs.Graphics.getRGB(0,255,0,0.5));this.shape.graphics.drawRect(0,0,640,60);this.shape.graphics.endFill();this.stage.addChild(this.shape);this.text=new createjs.Text("- PAUSED -","42px slickscreen",createjs.Graphics.getRGB(0,0,0,1));this.text.shadow=new createjs.Shadow(createjs.Graphics.getRGB(255,255,255,0.8),0,0,6);this.stage.addChild(this.text);this.shape.x=0;this.shape.y=190;this.text.x=180;this.text.y=200;};PausedText.prototype.clear=function(){if(this.text){this.stage.removeChild(this.text);this.text=null;}
if(this.shape){this.stage.removeChild(this.shape);this.shape=null;}};return PausedText;})();texts.PausedText=PausedText;})(goldenratio.texts||(goldenratio.texts={}));var texts=goldenratio.texts;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(utils){var AutoMouseHide=(function(){function AutoMouseHide(){}
AutoMouseHide.TIMEOUT_VALUE=3000;AutoMouseHide.prototype.init=function(){this.timeOutBind=this.onTimeout.bind(this);this.onMouseMoveBind=this.onMouseMoveHL.bind(this);document.addEventListener("mousemove",this.onMouseMoveBind,false);this.resetTimeout();};AutoMouseHide.prototype.resetTimeout=function(){if(this.timer){clearTimeout(this.timer);}
this.timer=setTimeout(this.timeOutBind,AutoMouseHide.TIMEOUT_VALUE);};AutoMouseHide.prototype.onTimeout=function(){document.body.style.cursor="none";};AutoMouseHide.prototype.onMouseMoveHL=function(event){if(event["webkitMovementX"]==0||event["webkitMovementY"]==0){return;}
this.resetTimeout();document.body.style.cursor="auto";};AutoMouseHide.prototype.dispose=function(){document.removeEventListener("mousemove",this.onMouseMoveBind,false);if(this.timer){clearTimeout(this.timer);}
this.timer=null;this.timeOutBind=null;this.onMouseMoveBind=null;document.body.style.cursor="auto";};return AutoMouseHide;})();utils.AutoMouseHide=AutoMouseHide;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){(function(utils){var HarlemShake=(function(){function HarlemShake(){this.currentCount=0;this.onTimerBindHL=this.onTimerHL.bind(this);this.onTimerCompleteBindHL=this.onTimerCompleteHL.bind(this);}
HarlemShake.VALUE=[{left:"-10px"},{left:"10px",top:"-10px"},{left:"0px",top:"10px"},{left:"-10px",top:"0px"},{left:"0px",top:"0px"}];HarlemShake.prototype.shake=function(container){if(this.timer||container==null){return;}
this.container=container;this.currentCount=0;this.timer=new utils.Timer(30,HarlemShake.VALUE.length+1);this.timer.addEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerBindHL);this.timer.addEventListener(goldenratio.utils.TimerEvent.TIMER_COMPLETE,this.onTimerCompleteBindHL);this.timer.start();};HarlemShake.prototype.onTimerHL=function(event){var obj=HarlemShake.VALUE[this.currentCount];if(obj["top"]){this.container.style.top=obj["top"];}
if(obj["left"]){this.container.style.left=obj["left"];}
this.currentCount+=1;};HarlemShake.prototype.onTimerCompleteHL=function(event){this.clear();};HarlemShake.prototype.clear=function(){if(this.timer){this.timer.removeEventListener(goldenratio.utils.TimerEvent.TIMER,this.onTimerBindHL);this.timer.removeEventListener(goldenratio.utils.TimerEvent.TIMER_COMPLETE,this.onTimerCompleteBindHL);this.timer.dispose();}
this.timer=null;};HarlemShake.prototype.dispose=function(){this.clear();this.onTimerBindHL=null;this.onTimerCompleteBindHL=null;};return HarlemShake;})();utils.HarlemShake=HarlemShake;})(goldenratio.utils||(goldenratio.utils={}));var utils=goldenratio.utils;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var Main=(function(_super){__extends(Main,_super);function Main(){_super.call(this);this.bulletList=[];this.bulletBoundaries=new createjs.Rectangle(-50,-50,700,530);this.stageProp=new createjs.Rectangle(0,0,640,480);console.log("main");var canvas=document.getElementById("slate");this.stage=new createjs.Stage(canvas);var shape=new createjs.Shape();shape.set({alpha:0.6});shape.graphics.beginFill("#000").drawRect(0,0,this.stageProp.width,this.stageProp.height);this.stage.addChild(shape);this.stage.autoClear=false;this.init();createjs.Ticker.useRAF=true;createjs.Ticker.setFPS(30);this.onTickerBind=this.onTicker.bind(this);createjs.Ticker.addEventListener("tick",this.onTickerBind);}
Main.prototype.init=function(){this.onToggleMuteBind=this.onToggleMute.bind(this);this.onTogglePauseBind=this.onTogglePause.bind(this);this.onMissionComplteBind=this.onMissionComplete.bind(this);this.keyboard=new goldenratio.utils.Keyboard();this.keyboard.addEventListener(goldenratio.utils.KeyEvent.PAUSE_TOGGLED,this.onTogglePauseBind);this.keyboard.addEventListener(goldenratio.utils.KeyEvent.MUTE_TOGGLED,this.onToggleMuteBind);this.keyboard.init();this.backgroundGrid=new goldenratio.BackgroundGrid();this.stage.addChild(this.backgroundGrid);this.healthBar=new goldenratio.elements.HealthBar();this.healthBar.x=430;this.healthBar.y=10;this.stage.addChild(this.healthBar);this.score=new goldenratio.texts.Score(this.stage);this.score.init();this.onFireBulletHandlerBind=this.onFireBulletHandler.bind(this);this.onHealthChangeHandlerBind=this.onHealthChangeHandler.bind(this);this.onDieHandlerBind=this.onDieHandler.bind(this);this.hero=new goldenratio.hero.Hero(this.keyboard);this.hero.addEventListener(goldenratio.hero.HeroEvent.FIRE_BULLET,this.onFireBulletHandlerBind);this.hero.addEventListener(goldenratio.hero.HeroEvent.PLAYER_HIT,this.onHealthChangeHandlerBind);this.hero.addEventListener(goldenratio.hero.HeroEvent.DIE,this.onDieHandlerBind);this.hero.addEventListener(goldenratio.hero.HeroEvent.MISSION_COMPLETE,this.onMissionComplteBind);this.hero.x=100;this.hero.y=200;this.stage.addChild(this.hero);this.healthBar.setValue(this.hero.getHealth());this.enemyManager=new goldenratio.enemies.EnemyManager(this.stage,this.hero,this.bulletList,this.score);this.enemyManager.init();this.muteIcon=new goldenratio.elements.MuteIcon();this.muteIcon.x=615;this.muteIcon.y=10;this.stage.addChild(this.muteIcon);this.redScreen=new goldenratio.elements.RedScreen();this.stage.addChild(this.redScreen);this.gameOverScreen=new goldenratio.screens.GameOverScreen(this.stage);this.pausedText=new goldenratio.texts.PausedText(this.stage);this.keyboard.setMute(createjs.Sound.getMute());this.showMuteIcon(createjs.Sound.getMute());this.autoMouseHide=new goldenratio.utils.AutoMouseHide();this.autoMouseHide.init();this.harlemShake=new goldenratio.utils.HarlemShake();};Main.prototype.onHealthChangeHandler=function(event){if(this.hero){this.healthBar.setValue(this.hero.getHealth());}
if(this.redScreen){this.redScreen.show();}};Main.prototype.onDieHandler=function(event){this.healthBar.setValue(0);var mainHolder=document.getElementById("main");if(mainHolder){this.harlemShake.shake(mainHolder);}};Main.prototype.onToggleMute=function(event){if(event.muteState==createjs.Sound.getMute()){return;}
createjs.Sound.setMute(event.muteState);this.showMuteIcon(event.muteState);};Main.prototype.showMuteIcon=function(state){if(state==true){this.muteIcon.show(true);createjs.Tween.get(this.healthBar).to({x:400},100);}else{this.muteIcon.show(false);createjs.Tween.get(this.healthBar).to({x:430},100);}};Main.prototype.onTogglePause=function(event){if(createjs.Ticker.getPaused()==event.pauseState){return;}
if(!this.pausedText){return;}
if(event.pauseState==true){this.pausedText.show();}else{this.pausedText.clear();}
this.stage.update();createjs.Ticker.setPaused(event.pauseState);if(this.enemyManager&&this.gameOverScreen.isGameOver==false){this.enemyManager.togglePause();}};Main.prototype.onFireBulletHandler=function(){var bullet=new goldenratio.Bullet();bullet.x=this.hero.x;bullet.y=this.hero.y;this.stage.addChild(bullet);this.bulletList.push(bullet);};Main.prototype.onGameOver=function(){this.gameOverScreen.show();this.enemyManager.stopSpawn();this.onStageMouseDownBind=this.onStageMouseDown.bind(this);this.stage.addEventListener("stagemousedown",this.onStageMouseDownBind);};Main.prototype.onMissionComplete=function(){this.gameOverScreen.showMissionComplete();this.enemyManager.stopSpawn();this.onStageMouseDownBind=this.onStageMouseDown.bind(this);this.stage.addEventListener("stagemousedown",this.onStageMouseDownBind);};Main.prototype.onStageMouseDown=function(){if(createjs.Ticker.getPaused()==true){return;}
this.stage.removeEventListener("stagemousedown",this.onStageMouseDownBind);createjs.Sound.play(goldenratio.SoundType.CLICK);this.dispatchEvent("show_title",null);};Main.prototype.dispose=function(){createjs.Ticker.removeEventListener("tick",this.onTickerBind);if(this.stage){this.stage.removeEventListener("stagemousedown",this.onStageMouseDownBind);this.stage.removeAllChildren();this.stage.removeAllEventListeners("stagemousedown");this.stage.clear();this.stage=null;}
if(this.hero){this.hero.removeEventListener(goldenratio.hero.HeroEvent.FIRE_BULLET,this.onFireBulletHandlerBind);this.hero.removeEventListener(goldenratio.hero.HeroEvent.PLAYER_HIT,this.onHealthChangeHandlerBind);this.hero.removeEventListener(goldenratio.hero.HeroEvent.DIE,this.onDieHandlerBind);this.hero.dispose();this.hero=null;}
if(this.backgroundGrid){this.backgroundGrid.dispose();this.backgroundGrid=null;}
if(this.keyboard){this.keyboard.removeEventListener(goldenratio.utils.KeyEvent.PAUSE_TOGGLED,this.onTogglePauseBind);this.keyboard.removeEventListener(goldenratio.utils.KeyEvent.MUTE_TOGGLED,this.onToggleMuteBind);this.keyboard.dispose();this.keyboard=null;}
if(this.bulletList){for(var i=0;i<this.bulletList.length;i++){this.bulletList[i].dispose();this.bulletList[i]=null;}
this.bulletList.length=0;this.bulletList=null;}
if(this.enemyManager){this.enemyManager.dispose();this.enemyManager=null;}
if(this.healthBar){this.healthBar.dispose();this.healthBar=null;}
if(this.redScreen){this.redScreen.dispose();this.redScreen=null;}
if(this.pausedText){this.pausedText.dispose();this.pausedText=null;}
if(this.score){this.score.dispose();this.score=null;}
if(this.gameOverScreen){this.gameOverScreen.dispose();this.gameOverScreen=null;}
if(this.autoMouseHide){this.autoMouseHide.dispose();this.autoMouseHide=null;}
if(this.harlemShake){this.harlemShake.dispose();this.harlemShake=null;}
this.bulletBoundaries=null;this.stageProp=null;this.stage=null;this.onTogglePauseBind=null;this.onToggleMuteBind=null;this.onFireBulletHandlerBind=null;this.onHealthChangeHandlerBind=null;this.onDieHandlerBind=null;this.onMissionComplteBind=null;this.onStageMouseDownBind=null;this.onTickerBind=null;};Main.prototype.onTicker=function(event){if(createjs.Ticker.getPaused()){return;}
var i;if(this.backgroundGrid){this.backgroundGrid.update();}
if(this.hero){this.hero.update();if(this.hero.canRemove==true){this.hero.removeEventListener(goldenratio.hero.HeroEvent.FIRE_BULLET,this.onFireBulletHandlerBind);this.hero.removeEventListener(goldenratio.hero.HeroEvent.PLAYER_HIT,this.onHealthChangeHandlerBind);this.hero.removeEventListener(goldenratio.hero.HeroEvent.DIE,this.onDieHandlerBind);this.hero.dispose();this.stage.removeChild(this.hero);this.hero=null;this.onGameOver();}}
if(this.bulletList){for(i=this.bulletList.length-1;i>=0;i--){this.bulletList[i].update();if(this.bulletList[i].x>this.bulletBoundaries.width){this.bulletList[i].dispose();this.stage.removeChild(this.bulletList[i]);this.bulletList[i]=null;this.bulletList.splice(i,1);}}}
if(this.enemyManager){this.enemyManager.update();}
if(this.stage){this.stage.update();}};return Main;})(createjs.EventDispatcher);goldenratio.Main=Main;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var HexagonPattern=(function(_super){__extends(HexagonPattern,_super);function HexagonPattern(){_super.call(this);this.list=[];this.stageProp=new createjs.Rectangle(0,0,640,480);this.direction=new createjs.Point(-1,1);this.loopCount=0;var rand=(Math.random()*2)>>0;if(rand==1){this.direction.x*=-1;}
rand=(Math.random()*2)>>0;if(rand==0){this.direction.y*=-1;}
for(var i=0;i<40;i++){var size=20+((Math.random()*5)>>0);var shape=new createjs.Shape(this.createHexagon(size));shape.x=((Math.random()*this.stageProp.width)>>0);shape.y=((Math.random()*this.stageProp.height)>>0);shape.alpha=0.1+((Math.random()*3)>>0)/10;shape.cache(-size,-size,(size*2),size*2);this.addChild(shape);this.list.push(shape);}}
HexagonPattern.prototype.dispose=function(){this.stageProp=null;if(this.list){this.list.length=0;this.list=null;}
this.direction=null;};HexagonPattern.prototype.createHexagon=function(size){var r=Math.random()*255>>0;var g=Math.random()*255>>0;var b=Math.random()*255>>0;var colorValue=createjs.Graphics.getRGB(r,g,b,1);var gfx=new createjs.Graphics();gfx.setStrokeStyle(2);gfx.beginStroke(colorValue);gfx.moveTo(size,0);var degree=0;for(var i=0;i<7;i++){var radians=degree*Math.PI/180;var hx=Math.cos(radians)*size;var hy=Math.sin(radians)*size;degree+=60;gfx.lineTo(hx,hy);}
gfx.endStroke();return gfx;};HexagonPattern.prototype.update=function(){for(var i=0;i<this.list.length;i++){if(this.list[i].rotation>=360){this.list[i].rotation=0;}else{this.list[i].rotation+=2;}
this.list[i].x+=1*this.direction.x;this.list[i].y+=1*this.direction.y;if(this.list[i].x<-50){this.list[i].x=this.stageProp.width+50;this.list[i].alpha=0.1+((Math.random()*3)>>0)/10;}
if(this.list[i].y<-50){this.list[i].y=this.stageProp.height+50;this.list[i].alpha=0.1+((Math.random()*3)>>0)/10;}
if(this.list[i].x>this.stageProp.width+50){this.list[i].x=-50;this.list[i].alpha=0.1+((Math.random()*3)>>0)/10;}
if(this.list[i].y>this.stageProp.height+50){this.list[i].y=-50;this.list[i].alpha=0.1+((Math.random()*3)>>0)/10;}}};return HexagonPattern;})(goldenratio.BasicDisplayObject);goldenratio.HexagonPattern=HexagonPattern;var TitleScreen=(function(_super){__extends(TitleScreen,_super);function TitleScreen(){_super.call(this);this.init();}
TitleScreen.prototype.init=function(){var canvas=document.getElementById("slate");this.stage=new createjs.Stage(canvas);createjs.Ticker.useRAF=true;createjs.Ticker.setFPS(30);this.onTickerBind=this.onTicker.bind(this);createjs.Ticker.addEventListener("tick",this.onTickerBind);this.hexagonPattern=new HexagonPattern();this.hexagonPattern.alpha=0;this.stage.addChild(this.hexagonPattern);this.gameNameText=new createjs.Text("SHAPE SHOOTER","60px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.gameNameText.x=55;this.gameNameText.y=120;this.gameNameText.alpha=0;this.gameNameText.shadow=new createjs.Shadow(createjs.Graphics.getRGB(255,255,255,1),0,0,4);this.stage.addChild(this.gameNameText);createjs.Tween.get(this.gameNameText).to({alpha:1},500).call(this.showStartGame.bind(this));this.creditsText=new createjs.Text("Programmed by Karthikeyan VJ \nusing CreateJS","10px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.creditsText.x=10;this.creditsText.y=450;this.stage.addChild(this.creditsText);createjs.Tween.get(this.hexagonPattern).to({alpha:1},1000);};TitleScreen.prototype.showStartGame=function(){this.showInstructions();this.startGameText=new createjs.Text("click to start game!","18px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.startGameText.x=210;this.startGameText.y=380;this.stage.addChild(this.startGameText);this.onStageMouseDownBind=this.onStageMouseDown.bind(this);this.stage.addEventListener("stagemousedown",this.onStageMouseDownBind);};TitleScreen.prototype.showInstructions=function(){this.instructionText=new createjs.Text("- Controls -","15px slickscreen",createjs.Graphics.getRGB(193,196,196,0.7));this.instructionText.x=250;this.instructionText.y=240;this.stage.addChild(this.instructionText);this.instructionInfoText=new createjs.Text("use ARROW keys to move, Z - Fire, M - mute, P - Pause","14px slickscreen",createjs.Graphics.getRGB(193,196,196,1));this.instructionInfoText.x=80;this.instructionInfoText.y=260;this.stage.addChild(this.instructionInfoText);};TitleScreen.prototype.onStageMouseDown=function(){console.log("start game!");this.stage.removeEventListener("stagemousedown",this.onStageMouseDownBind);createjs.Sound.play(goldenratio.SoundType.CLICK);this.blocker=new createjs.Shape();this.blocker.graphics.beginFill(createjs.Graphics.getRGB(0,0,0));this.blocker.graphics.drawRect(0,0,640,480);this.blocker.graphics.endFill();this.blocker.alpha=0;this.stage.addChild(this.blocker);createjs.Tween.get(this.blocker).to({alpha:1},500).call(this.startGame.bind(this));};TitleScreen.prototype.startGame=function(){this.dispatchEvent("start_game",null);};TitleScreen.prototype.dispose=function(){createjs.Ticker.removeEventListener("tick",this.onTickerBind);if(this.stage){this.stage.removeEventListener("stagemousedown",this.onStageMouseDownBind);this.stage.removeAllChildren();this.stage.removeAllEventListeners("stagemousedown");this.stage.clear();}
this.stage=null;this.creditsText=null;this.gameNameText=null;this.startGameText=null;this.instructionInfoText=null;this.instructionText=null;this.blocker=null;if(this.hexagonPattern){this.hexagonPattern.dispose();this.hexagonPattern=null;}
this.onStageMouseDownBind=null;this.onTickerBind=null;};TitleScreen.prototype.onTicker=function(event){if(this.stage){this.stage.update();}
if(this.hexagonPattern){this.hexagonPattern.update();}};return TitleScreen;})(createjs.EventDispatcher);goldenratio.TitleScreen=TitleScreen;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));var com;(function(com){(function(goldenratio){var ManifestData=(function(){function ManifestData(id,src){this.id=id;this.src=src;}
return ManifestData;})();goldenratio.ManifestData=ManifestData;var Loader=(function(){function Loader(){this.manifest=[];this.manifest=[new ManifestData(goldenratio.SoundType.LASER,"assets/sfx/laser.mp3|assets/sfx/laser.ogg"),new ManifestData(goldenratio.SoundType.ENEMY_HIT,"assets/sfx/enemy_hit.mp3|assets/sfx/enemy_hit.ogg"),new ManifestData(goldenratio.SoundType.PLAYER_HIT,"assets/sfx/player_hit.mp3|assets/sfx/player_hit.ogg"),new ManifestData(goldenratio.SoundType.CLICK,"assets/sfx/click.mp3|assets/sfx/click.ogg"),new ManifestData(goldenratio.SoundType.ENEMY_SINGLE_HIT,"assets/sfx/enemy_single_hit.mp3|assets/sfx/enemy_single_hit.ogg"),new ManifestData(goldenratio.SoundType.PLAYER_DIE,"assets/sfx/hero_die.mp3|assets/sfx/hero_die.ogg"),new ManifestData(goldenratio.GraphicsType.MUTE,"assets/gfx/mute.png")];createjs.Sound.registerPlugins([createjs.WebAudioPlugin]);if(createjs.WebAudioPlugin.isSupported()){console.log("ya! can play sound!");}
this.init();this.queue=new createjs.LoadQueue(true);this.queue.installPlugin(createjs.Sound);this.onFileLoadBind=this.onFileLoad.bind(this);this.onLoaderCompleteBind=this.onLoaderComplete.bind(this);this.onFileLoadErrorBind=this.onFileLoadError.bind(this);this.onFileProgressBind=this.onFileProgress.bind(this);this.queue.addEventListener("fileload",this.onFileLoadBind);this.queue.addEventListener("complete",this.onLoaderCompleteBind);this.queue.addEventListener("error",this.onFileLoadErrorBind);this.queue.addEventListener("progress",this.onFileProgressBind);this.queue.loadManifest(this.manifest);}
Loader.prototype.init=function(){var canvas=document.getElementById("slate");this.stage=new createjs.Stage(canvas);createjs.Ticker.useRAF=true;createjs.Ticker.setFPS(30);this.onTickerBind=this.onTicker.bind(this);createjs.Ticker.addEventListener("tick",this.onTickerBind);this.loaderText=new createjs.Text("Loading 0%","18px slickscreen",createjs.Graphics.getRGB(255,255,255,1));this.loaderText.x=10;this.loaderText.y=10;this.stage.addChild(this.loaderText);};Loader.prototype.onFileLoadError=function(event){var data=event.item;console.log("error.. "+data.src);};Loader.prototype.onFileLoad=function(event){var data=event.item;console.log("load complete.. "+data.src);};Loader.prototype.onFileProgress=function(event){if(this.loaderText){this.loaderText.text="Loading "+(((event.progress*100)+0.5)>>0)+"%";}};Loader.prototype.onLoaderComplete=function(event){console.log("loader done!");this.disposeQueue();goldenratio.RES.init(this.queue);this.showTitleHL=this.showTitleScreen.bind(this);this.onStartGameHL=this.showGameScreen.bind(this);this.showTitleScreen();};Loader.prototype.disposeQueue=function(){if(this.stage){this.stage.removeAllChildren();this.stage.clear();}
createjs.Ticker.removeEventListener("tick",this.onTickerBind);this.queue.removeEventListener("fileload",this.onFileLoadBind);this.queue.removeEventListener("complete",this.onLoaderCompleteBind);this.queue.removeEventListener("error",this.onFileLoadErrorBind);this.queue.removeEventListener("progress",this.onFileProgressBind);this.manifest=null;this.loaderText=null;this.stage=null;this.onTickerBind=null;this.onFileLoadBind=null;this.onFileLoadBind=null;this.onFileLoadErrorBind=null;this.onFileProgressBind=null;};Loader.prototype.onTicker=function(event){if(this.stage){this.stage.update();}};Loader.prototype.showGameScreen=function(){this.disposeTitleScreen();this.disposeMainGame();this.game=new goldenratio.Main();this.game.addEventListener("show_title",this.showTitleHL);};Loader.prototype.disposeMainGame=function(){if(this.game){this.game.removeEventListener("show_title",this.showTitleHL);this.game.dispose();this.game=null;}};Loader.prototype.showTitleScreen=function(){this.disposeMainGame();this.disposeTitleScreen();this.titleScreen=new goldenratio.TitleScreen();this.titleScreen.addEventListener("start_game",this.onStartGameHL);};Loader.prototype.disposeTitleScreen=function(){if(this.titleScreen){this.titleScreen.removeEventListener("start_game",this.onStartGameHL);this.titleScreen.dispose();this.titleScreen=null;}};return Loader;})();goldenratio.Loader=Loader;})(com.goldenratio||(com.goldenratio={}));var goldenratio=com.goldenratio;})(com||(com={}));window.addEventListener("load",onLoad,false);function onLoad(event){var loader=new com.goldenratio.Loader();}